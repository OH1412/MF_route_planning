# MF_route_planning 路径规划项目

## 项目简介
MF_route_planning 是一个基于网格环境的路径规划项目，主要实现了 Dijkstra 和 A* 等路径搜索算法，用于在包含高度变化、特殊站点（KFS1、KFS2）和锁定区域的网格中寻找最优路径。项目支持路径可视化，可直观展示路径规划结果、高度分布及特殊站点位置。

## 核心功能
- 基于 Dijkstra 算法的最短路径规划（考虑高度变化耗时）
- 基于 A* 算法的带启发式优化路径搜索（支持特殊站点调度）
- 网格环境可视化（含高度分布、入口/出口、路径箭头标记）
- 特殊站点（KFS1、KFS2）位置配置与锁定区域处理

## 环境依赖
- Python 3.x
- matplotlib（用于可视化）
- numpy（辅助计算）

安装依赖：
```bash
pip install matplotlib numpy
```

## 文件结构说明
```
MF_route_planning/
├── drawing.py               # 绘制设定图像
├── star_with_R1_route.py    # 含有R1协同规划的代码实现
└── star_route_with_timer.py # 添加规划耗时
```

## 主要模块说明

### 1. Dijkstra 算法模块（Dijkstra.py）
实现经典 Dijkstra 算法，用于寻找从入口节点（1-3）到出口节点（10-12）的最短路径，考虑：
- 网格节点的4-连通性（上下左右移动）
- 高度变化耗时（上升/下降不同高度的时间成本）
- 路径可视化（含高度颜色映射、入口出口标记、路径箭头）

运行示例：
```bash
python Dijkstra.py
```
输出：
- 最短路径总时间
- 路径节点序列
- 可视化路径图（含高度标注和路径箭头）

### 2. 可视化模块（drawing.py）
提供网格环境的高级可视化功能：
- 内层网格（4行3列）与外层粉色跑道的展示
- KFS1、KFS2 站点位置标记
- 锁定区域标记
- 高度颜色映射（200mm/400mm/600mm 对应不同颜色）

运行示例：
```bash
python drawing.py
```
输出：包含站点配置的网格可视化图

### 3. A* 算法模块（star_with_R1.py 等）
增强版路径规划算法，支持：
- 曼哈顿距离启发式函数
- KFS1 站点的异步调度（不占用机器人时间）
- KFS2 站点的拾取/清理操作
- 锁定区域避让

## 自定义配置
可通过修改代码中的参数进行自定义：
- **高度配置**：在 `heights` 字典中修改各节点的高度（200/400/600mm）
- **时间参数**：在 `times` 字典中调整移动、上升、下降等操作的耗时
- **站点配置**：在 `drawing.py` 或算法文件中修改 KFS1、KFS2 位置及锁定区域

## 示例输出说明
- 路径节点序列：如 `[1, 2, 5, 8, 11, 12]` 表示从节点1到节点12的路径
- 总时间：路径的累计耗时（含移动和高度变化时间）
- 可视化图：
  - 不同颜色代表不同高度（浅蓝色：200mm，浅黄色：400mm，浅红色：600mm）
  - 绿色圆圈标记入口，红色圆圈标记出口
  - 蓝色箭头标记路径方向

## 注意事项
- 确保 matplotlib 中文字体正常显示（代码已配置 `WenQuanYi Micro Hei` 字体）
- 若出现路径不可达错误，检查是否存在锁定区域阻塞所有路径
- 自定义高度时需注意仅支持 200/400/600mm 三种高度值（否则可能触发未处理的高度变化错误）
